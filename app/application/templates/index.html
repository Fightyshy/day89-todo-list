{% include "header.html" %}
        <!-- Header end -->
        {% from 'bootstrap5/form.html' import render_form %}
        <!-- Body start -->
        <div class="d-flex flex-column flex-md-row p-4 gap-4 py-md-5 align-items-center justify-content-center">
            {% if tasks is not none %}
            <div class="list-group w-100">
                {% for item in tasks.tasks: %}
                <label class="list-group-item d-flex gap-3">
                    <!-- TODO if to ajax to edit recived, turn form from viewing to form editting mode -->
                    <input hidden="true" value="{{ item.id }}" id="task-id"/>
                    {% if item.complete %}
                    <input class="form-check-input flex-shrink-0" type="checkbox" style="font-size: 1.375em;" id="task-checkbox-{{item.id}}" name="task-checkbox-{{item.id}}" checked>
                    {% else %}
                    <input class="form-check-input flex-shrink-0" type="checkbox" style="font-size: 1.375em;" id="task-checkbox-{{item.id}}" name="task-checkbox-{{item.id}}">
                    {% endif %}
                    <div class="d-flex gap-2 w-100 justify-content-md-between">
                        <div>
                            <div id="name">
                                <h2 id="task-name-{{item.id}}" contenteditable="true" class="mb-0">{{ item.name }}</h2>
                            </div>
                            <div id="notes">
                                <h6 id="task-notes-{{item.id}}" class="mb-0 opacity-75 w-75 text-wrap" contenteditable="true">{{ item.notes }}</h6>
                            </div>
                        </div>
                        <div>
                            Date Set: <input type="datetime-local" class="form-control" value="{{item.date_set}}" disabled>
                            Date Due: <input id="task-date-due-{{item.id}}" type="datetime-local" class="form-control" value="{{item.date_due}}">
                        </div>
                        <small class="opacity-50 text-nowrap">
                            <button id="edit-{{item.id}}"  class="btn btn-primary ml-4">Save</button>
                            <a href="{{ url_for('tasklist.delete_task', list_id=tasks.listId, task_id=item.id) }}" class="btn btn-primary">Delete</a>
                        </small>
                    </div>
                    
                    <!-- TODO change edit to convert text to form field and back -->
                    <!-- TODO Update AJAX, send serialised form -->
                    <script type="text/javascript">
                        $(document).ready(function() {

                            $("#task-checkbox-{{item.id}}").change(function(event){
                                event.preventDefault();
                                data = {checked: false, taskid: $("#task-id").val()}
                                if(this.checked){
                                    data["checked"]= true;
                                }

                                $.ajax({
                                    data:JSON.stringify(data),
                                    type: "POST",
                                    contentType: "application/json",
                                    url: "{{url_for('tasklist.set_task_check', list_id=tasks.listId, task_id=item.id)}}"
                                }).done(function(data) {
                                    $("#test").text("Box checked").show();
                                })
                            })
                        });
                        // $(document).ready(function() {
                        //     $("#task-checkbox-{{item.id}}").change(function(event) {
                        //         if(this.checked){
                        //             $.ajax({
                        //                 data:{
                        //                     checked: true,
                        //                     taskid: $("#task-id").val()
                        //                 },
                        //                 type: "POST",
                        //                 url:"/{{tasks.listId}}"
                        //             }).done(function(data){
                        //                 $("#test").text("Box checked").show()
                        //             })
                        //             event.preventDefault()
                        //         }else{
                        //             $.ajax({
                        //                 data:{
                        //                     checked: false,
                        //                     taskid: $("#item-id").val()
                        //                 },
                        //                 type: "POST",
                        //                 url:"/{{tasks.listId}}"
                        //             }).done(function(data){
                        //                 $("#test").text("Box unchecked").show()
                        //             })
                        //             event.preventDefault()
                        //         }
                        //     })
                        // })
                        
                        // // Edit contents
                        // $(document).ready(function() {
                        //     $("#edit-{{item.id}}").click(function(event){
                        //         console.log("{{item.id}}")
                        //         $.ajax({
                        //             data:{
                        //                 id: "{{item.id}}",
                        //                 name: $("#task-name-{{item.id}}").text(),
                        //                 notes: $("#task-notes-{{item.id}}").text(),
                        //                 datedue: $("#task-date-due-{{item.id}}").val()
                        //             },
                        //             type: "POST",
                        //             url: "/task/{{item.id}}"
                        //         }).done(function(data){
                        //             $("#task-name-{{item.id}}").text(data.name),
                        //             $("#task-notes-{{item.id}}").text(data.notes),
                        //             $("#task-date-due-{{item.id}}").val(data.datedue)
                        //         })
                        //         event.preventDefault()
                        //     })
                        // })
                    </script>
                </label>
                {% endfor %}
                {% endif %}
                <!-- Form here, set id for ajax -->
                <div class="list-group-item d-flex gap-3 bg-body-tertiary">
                    {{ render_form(form, action=url_for('tasklist.add_task', list_id=list_id), form_type="inline", novalidate=True) }}
                </div>
            </div>
        </div>
        <!-- Body end -->

        <!-- Footer-->
    </body>
</html>